ğŸ¯ **TOP PRIORITY NOW:

FULL, ROBUST, STABLE IMPORT PIPELINE FOR ALL MOBILE DEVICES & REMOVABLE STORAGE**

Meaning:

âœ” Android phones (MTP or mounted DCIM)
âœ” iPhones (DCIM via Apple Mobile Device driver, or as PTP)
âœ” SD cards
âœ” USB sticks
âœ” External hard drives
âœ” Cloud-local caches (later but same pipeline)

And:

âœ” Detect a device
âœ” Read its media
âœ” Import the original files
âœ” Track import history
âœ” Detect changes next time
âœ” Incremental synchronization
âœ” Preserve the deviceâ€™s internal structure in the DB
âœ” Recreate the structure even when device is unplugged
âœ” Refresh thumbnails
âœ” Avoid duplicates
âœ” Multi-pass import (resume on reconnect)
âœ” Support for both Photos + Videos (separated in the UI)

This core functionality is far more important than cloud albums.
This core will influence:

Date Branches

Event Clustering

Face Recognition later

Tag system

Lightbox

Sorting

User experience

Performance

Cloud integration should ONLY be added after this foundation is locked in.

ğŸŸ¨ THIS IS EXACTLY WHAT PROFESSIONAL APPS DO
Apple Photos

Imports entire device â†’ creates a local master index â†’ incremental sync next time.

Lightroom

Imports entire SD card â†’ builds catalog â†’ incremental folder updates.

Mylio

Treats devices as â€œSourcesâ€ with incremental sync.

ImageRanger

Scans folders â†’ local database â†’ incremental re-scan.

Google Photos

Syncs device library â†’ dedup â†’ cloud DB.

â¡ï¸ All follow the same universal model:
Device â†’ Local-DB Index â†’ Incremental Sync

You are now making MemoryMate-PhotoFlow behave like a serious photo management engine.

ğŸŸ¦ RECOMMENDED ARCHITECTURE FOR YOUR APP (Phase NOW)

Below is the architecture I strongly recommend based on your goals.

âœ” Step 1 â€” Device Scanner (Detect device / SD / external drive)

Maintain:

device_sources.py


Add:

Device ID extraction

Android phones â†’ MTP device serial
iPhone â†’ PTP UUID
SD card â†’ Volume GUID
USB stick â†’ Volume GUID

Store in DB:

device_id
device_name
first_seen
last_seen
physical_type (ios, android, sd, usb)

âœ” Step 2 â€” Device Indexer (read DCIM, subfolders, videos)

Instead of scanning EVERY folder every time:

Store per-file metadata:
path
filename
size
mtime
hash (optional, SHA1)
imported_ts
device_id

Mark state transitions:

New

Modified

Deleted

Moved

Already imported

This allows incremental sync.

âœ” Step 3 â€” Local Media Archive (Permanent Storage)

Your app should store:

/photos
/videos
/thumbnails
/import_history
/device_cache/device_id/

âœ” Step 4 â€” Incremental Sync Engine

When a device reconnects:

1. Identify device by ID
2. Read DCIM structure
3. Compare with DB
4. Only import:
   - new files
   - modified files
   - missing thumbnails
5. Maintain DB references


This is extremely powerful.

âœ” Step 5 â€” Folder/Album Reconstruction (Auto-build MemoryMate structure)

Based entirely on:

Modified Date

Creation Date

EXIF original date

Video metadata

Image content (optional later)

This produces:

âœ” Year / Month / Day
âœ” Event clusters
âœ” Trip groups
âœ” Smart sets (People, Favorites, etc.)
âœ” Saved views

No need for Google/iCloud albums currently.

âœ” Step 6 â€” The UI should show:
Photos (Camera roll content)
Videos (Separated)
Timeline (date clusters)
Device History (previous imports)
Sync State
Missing originals?
Restart import
ğŸŸ§ WHAT YOU SHOULD NOT DO NOW

(And postpone until the above pipeline is complete)

Cloud album picker

Manual photo selection inside cloud albums

Smart AI albums

Location clustering

Faces UI

Advanced tags

Lightbox editing tools

Cloud device sync logic

Multi-process clusterers

These depend 100% on the import pipeline working perfectly.

ğŸŸ¥ THE CURRENT STATE OF YOUR APP

From the ZIP audit yesterday:

âœ” UI is progressing nicely
âœ” Sidebar has core logic
âœ” Grid is functional
âœ” Thumbnails mostly work
âŒ Import pipeline is NOT stable yet
âŒ Device history is NOT implemented
âŒ Incremental sync is NOT implemented
âŒ Device ID tracking is NOT implemented
âŒ Removing device breaks UI
âŒ Video metadata branch is incomplete
âŒ Backfill video dates is half-finished
âŒ Date branches logic is not stable

You are doing the RIGHT THING:
Freeze everything and finalize import pipeline first.

ğŸŸ© MY STRONG RECOMMENDATION
âœ” YES â€” postpone album picker
âœ” YES â€” stabilize device import
âœ” YES â€” build incremental sync
âœ” YES â€” store device history
âœ” YES â€” unify Photos+Videos import
âœ” YES â€” keep cloud only as â€œsource of filesâ€
âœ” YES â€” let your app build all albums locally

This creates a professional-grade photo engine.

ğŸŸ¦ NEXT STEPS I CAN DO FOR YOU

If you confirm, I will generate:

**1. A Full Plan:

"MemoryMate Import Pipeline Version 1.0"**
including:

Device ID subsystem

Device mount detection

Physical + virtual path mapping

DCIM scanner (photos + videos)

DB schema update (device_files table, incremental state flags)

Import service rewrite

Incremental scanning logic

Sync event signals

Metadata enrichment

Thumbnail refresh

Device history view in Sidebar

2. A Unified .patch file

Implementing the foundation:

new device_indexer.py

new DB tables

rewritten import_service.py

new sidebar_sync_panel_qt.py

updated sidebar_qt.py

updated thumbnails_grid_qt.py

updated event signals

3. UI Mockups

For:

Device Structure

Incremental sync dialog

Sync summary

Device history

4. Step-by-step testing instructions

For:

First import

Reconnect

Incremental update

Delete on device â†’ reflect (but keep local copy)

New photos â†’ detect and import

Videos â†’ correct date mapping

Normalization tests

Missing originals detection
