--- /mnt/data/mm_orig/main_window_qt.py	2026-02-07 12:59:02.000000000 +0000
+++ /mnt/data/mm_mod/main_window_qt.py	2026-02-07 17:33:46.788322562 +0000
@@ -55,6 +55,7 @@
 # Add imports near top if not present:
 
 from PySide6.QtCore import Qt, QThread, QSize, QThreadPool, Signal, QObject, QRunnable, QEvent, QTimer, QProcess, QItemSelectionModel, QRect
+from utils.qt_guards import connect_guarded
 
 from PySide6.QtGui import QPixmap, QImage, QImageReader, QAction, QActionGroup, QIcon, QTransform, QPalette, QColor, QGuiApplication
 
@@ -311,8 +312,11 @@
         self.setWindowTitle("MemoryMate - PhotoFlow")
         
         # keep rest of initializer logic, but ensure some attributes exist
-        # keep rest of initializer logic, but ensure some attributes exist
-        self.settings = SettingsManager()
+        # keep rest of initializer logic, but ensure some attributes exist        self.settings = SettingsManager()
+
+        # Generation token for guarding worker -> UI callbacks
+        # Increment this whenever the UI is logically restarted/replaced.
+        self._ui_generation: int = int(getattr(self, "_ui_generation", 0))
         self._committed_total = 0
         self._scan_result = (0, 0)  # folders, photos
 
@@ -3643,6 +3647,11 @@
             pass
 
 
+    def bump_ui_generation(self) -> int:
+        """Increment and return the current UI generation token."""
+        self._ui_generation = int(getattr(self, "_ui_generation", 0)) + 1
+        return self._ui_generation
+
     def closeEvent(self, event):
         """Ensure thumbnail threads and caches are closed before app exit."""
         try:
